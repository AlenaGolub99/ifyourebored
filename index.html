<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Мне скучно</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#111a2f;
      --text:#e8eefc;
      --muted:#a8b3d6;
      --chip-bg: rgba(255,255,255,0.05);
      --chip-border: rgba(255,255,255,0.14);
      --chip-on-bg: rgba(55,198,255,0.14);
      --chip-on-border: rgba(55,198,255,0.45);
    }

    * { box-sizing: border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      padding: 28px 16px;
      background: radial-gradient(1200px 600px at 50% 20%, #1a2a55 0%, var(--bg) 55%);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .card{
      width: min(820px, 100%);
      background: color-mix(in srgb, var(--card) 92%, transparent);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 22px;
      padding: 26px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.45);
      backdrop-filter: blur(10px);
    }

    .top{
      text-align:center;
      display:grid;
      gap: 14px;
    }

    h1{
      margin:0;
      font-size: clamp(30px, 3.5vw, 44px);
      letter-spacing: 0.2px;
    }

    .subtitle{
      margin:0;
      color: var(--muted);
      line-height: 1.45;
      font-size: 15px;
    }

    /* Поле результата видно сразу */
    .resultInput{
      width: 100%;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      padding: 14px 14px;
      font-size: 16px;
      outline: none;
      text-align: center;
    }
    .resultInput::placeholder{
      color: rgba(232,238,252,0.55);
    }

    .spacerBig{ height: 10px; } /* больше воздуха */

    .btnWrap{
      display:flex;
      justify-content:center;
      margin-top: 6px;
      margin-bottom: 6px;
    }

    button.primary{
      appearance:none;
      border:0;
      border-radius: 14px;
      padding: 14px 20px;
      font-size: 16px;
      font-weight: 700;
      cursor:pointer;
      background: linear-gradient(135deg, #7c5cff, #37c6ff);
      color:#081022;
      box-shadow: 0 10px 28px rgba(55,198,255,0.25);
      transition: transform .08s ease, filter .15s ease;
    }
    button.primary:hover{ filter: brightness(1.03); }
    button.primary:active{ transform: translateY(1px) scale(0.99); }

    .hint{
      margin-top: 2px;
      font-size: 12px;
      color: rgba(232,238,252,0.55);
      text-align:center;
    }
    kbd{
      font-family: inherit;
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.06);
    }

    .panel{
      margin-top: 18px;
      padding: 16px;
      border-radius: 16px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.08);
    }

    .panelTitle{
      margin:0 0 12px;
      font-size: 14px;
      letter-spacing: .2px;
      color: rgba(232,238,252,0.92);
      text-align:center;
    }

    /* Теги НЕ наслаиваются: делаем сетку */
    .chipsGrid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      align-items: stretch;
    }

    .chip{
      width:100%;
      user-select:none;
      cursor:pointer;
      border-radius: 999px;
      padding: 10px 12px;
      border: 1px solid var(--chip-border);
      background: var(--chip-bg);
      color: rgba(232,238,252,0.92);
      font-size: 13px;
      font-weight: 600;
      display:flex;
      justify-content:center;
      align-items:center;
      text-align:center;
      transition: transform .08s ease, background .15s ease, border-color .15s ease;
      white-space: nowrap;
    }
    .chip:active{ transform: scale(0.99); }
    .chip[aria-pressed="true"]{
      background: var(--chip-on-bg);
      border-color: var(--chip-on-border);
    }

    .muted{
      margin-top: 10px;
      color: rgba(232,238,252,0.6);
      font-size: 12px;
      line-height:1.35;
      text-align:center;
    }

    footer{
      margin-top: 16px;
      text-align:center;
      color: rgba(232,238,252,0.6);
      font-size: 12px;
    }
    footer a{
      color: rgba(55,198,255,0.95);
      text-decoration: none;
      border-bottom: 1px dashed rgba(55,198,255,0.5);
    }
  </style>
</head>

<body>
  <main class="card">
    <div class="top">
      <h1>Мне скучно</h1>

      <!-- Поле видно сразу -->
      <input
        id="resultField"
        class="resultInput"
        type="text"
        placeholder="Нажми кнопку, и тут появится идея"
        readonly
        aria-live="polite"
      />

      <p class="subtitle">Выбери режимы (по желанию) и нажми кнопку - выпадет случайное занятие.</p>

      <!-- больше расстояния сверху/снизу -->
      <div class="spacerBig"></div>

      <div class="btnWrap">
        <button id="btn" class="primary" type="button">Чем мне заняться?</button>
      </div>

      <div class="spacerBig"></div>

      <div class="hint">Можно нажать <kbd>Enter</kbd> или <kbd>Space</kbd>, когда кнопка в фокусе</div>
    </div>

    <section class="panel">
      <h2 class="panelTitle">Режимы</h2>
      <div id="chips" class="chipsGrid" role="group" aria-label="Режимы (фильтры)"></div>
      <div class="muted">
        Логика исправлена: идеи "С питомцем / С друзьями / Со второй половинкой" появляются только если выбран этот режим.
      </div>
    </section>

    <!-- "Свои идеи" убрали, как ты просила. Тут можно вставить ссылку на Google Form позже -->
    <section class="panel">
      <h2 class="panelTitle">Добавить свои идеи</h2>
      <div class="muted">
        Тут будет Google Form. Когда дашь ссылку на форму - я вставлю ее красиво кнопкой.
      </div>
    </section>

    <footer>
      Автор сайта Алена Голубь -
      <a href="https://t.me/agolub99" target="_blank" rel="noopener noreferrer">t.me/@agolub99</a>
    </footer>
  </main>

  <script>
    // ====== РЕЖИМЫ ======
    // Переименовано: "Прокачка" -> "Саморазвитие", "Спокойно" -> "Релакс"
    // Добавлены: Хобби, В интернете, С друзьями, Со второй половинкой, С питомцем
    const TAGS = [
      { id: "home",     label: "Дома" },
      { id: "outside",  label: "На улице" },
      { id: "online",   label: "В интернете" },

      { id: "short",    label: "На 5 минут" },
      { id: "free",     label: "Без денег" },
      { id: "creative", label: "Творчество" },
      { id: "active",   label: "Активность" },
      { id: "relax",    label: "Релакс" },
      { id: "learn",    label: "Саморазвитие" },
      { id: "hobby",    label: "Хобби" },

      { id: "friends",  label: "С друзьями" },
      { id: "couple",   label: "Со второй половинкой" },
      { id: "pet",      label: "С питомцем" }
    ];

    // Эти теги считаем "особенными": если идея помечена таким тегом,
    // она НЕ должна выпадать, пока пользователь явно не выберет режим.
    const GATED_TAGS = new Set(["pet", "friends", "couple"]);

    // "Локации" - чтобы не было странных совпадений типа "Дома" + "Прогуляться"
    // Если выбрана локация, идеи должны соответствовать выбранной локации.
    const LOCATION_TAGS = new Set(["home", "outside", "online"]);

    // ====== ИДЕИ ======
    // Я оставил много идей и поправил теги, чтобы не было нелогичных пересечений.
    const IDEAS = [
      // Дома
      { text: "Почитать книгу 15-20 минут", tags: ["home","relax","learn","free"] },
      { text: "Слепить из пластилина что-нибудь смешное", tags: ["home","creative","hobby"] },
      { text: "Нарисовать 5-минутный скетч (что угодно)", tags: ["home","short","creative","free","hobby"] },
      { text: "Навести порядок на одном участке (стол или полка)", tags: ["home","short","free"] },
      { text: "Сделать чай или какао и устроить уютную паузу", tags: ["home","relax"] },
      { text: "Сделать растяжку 7 минут", tags: ["home","active","short","free"] },
      { text: "Устроить мини-дневник: 3 хороших события за день", tags: ["home","relax","free","learn"] },
      { text: "Собрать пазл или конструктор", tags: ["home","relax","hobby"] },
      { text: "Разобрать галерею: удалить 30 лишних фото", tags: ["home","short","free"] },
      { text: "Сделать 10-минутную уборку под музыку", tags: ["home","active","free"] },
      { text: "Составить список дел на завтра, чтобы стало легче", tags: ["home","short","learn","free"] },
      { text: "Написать мини-историю на 5 предложений", tags: ["home","short","creative","free"] },
      { text: "Сделать бумажный самолетик и проверить дальность полета", tags: ["home","creative","short","free","hobby"] },
      { text: "Сделать 10-20 приседаний и 1 минуту планки", tags: ["home","short","active","free"] },
      { text: "Потренировать осанку 5 минут (плечи назад, шея ровно)", tags: ["home","short","learn","free"] },

      // На улице
      { text: "Прогуляться 10-15 минут", tags: ["outside","active","free","short"] },
      { text: "Сделать мини-квест: найти 5 красивых деталей вокруг", tags: ["outside","relax","free","short"] },
      { text: "Пройтись без телефона 10 минут и просто смотреть вокруг", tags: ["outside","relax","free","short"] },
      { text: "Сделать 10 фото природы/города с необычными ракурсами", tags: ["outside","creative","free","hobby"] },
      { text: "Легкая пробежка или быстрый шаг 8 минут", tags: ["outside","active","free","short"] },

      // В интернете
      { text: "Посмотреть короткий документальный ролик", tags: ["online","relax","learn","free"] },
      { text: "Послушать подкаст на интересную тему", tags: ["online","relax","learn","free"] },
      { text: "Сыграть в короткую игру в браузере", tags: ["online","relax","short"] },
      { text: "Пройти веселый квиз или тест", tags: ["online","relax","short"] },
      { text: "Выучить 10 новых слов (любая тема)", tags: ["online","short","learn","free"] },
      { text: "Найти 1 новый навык и изучить 10 минут (видео/статья)", tags: ["online","learn","short","free"] },
      { text: "Собрать плейлист под настроение", tags: ["online","relax","hobby"] },
      { text: "Найти простой туториал и повторить (рисование/рукоделие)", tags: ["online","creative","hobby","learn"] },

      // Универсальные (без локации)
      { text: "Составить список желаний: 10 вещей, которые хочешь", tags: ["relax","learn","free"] },
      { text: "Сделать 5 минут дыхания: вдох 4, выдох 6", tags: ["relax","short","free"] },
      { text: "Поставить мини-цель на день и сделать первый шаг", tags: ["learn","short","free"] },
      { text: "Послушать музыку и просто полежать 10 минут", tags: ["relax"] },

      // GATED: С питомцем (появятся только если выбран режим pet)
      { text: "Поиграть с питомцем 10 минут (мячик/веревочка)", tags: ["pet","active","short"] },
      { text: "Сделать питомцу простую игрушку из безопасных материалов", tags: ["pet","creative","free","hobby"] },
      { text: "Научить питомца одной простой команде (если возможно)", tags: ["pet","learn","short"] },
      { text: "Прогуляться с питомцем 10-15 минут", tags: ["pet","outside","active","free"] },

      // GATED: С друзьями
      { text: "Написать другу: 'Как ты? Давай созвонимся на 10 минут'", tags: ["friends","online","free","short"] },
      { text: "Устроить мини-викторину с друзьями", tags: ["friends","online","relax"] },
      { text: "Сделать совместный плейлист с друзьями", tags: ["friends","online","relax","hobby"] },
      { text: "Сыграть с друзьями в настолку или карточную игру", tags: ["friends","relax","hobby"] },

      // GATED: Со второй половинкой
      { text: "Придумать 3 идеи для свидания и выбрать одну", tags: ["couple","relax"] },
      { text: "Сыграть вместе в игру (настолка/карты/видео)", tags: ["couple","relax","hobby"] },
      { text: "Сделать вместе чай/какао и устроить разговор без телефонов", tags: ["couple","relax"] }
    ];

    // ====== ЛОГИКА ВЫБОРА ======
    const chipsWrap = document.getElementById("chips");
    const btn = document.getElementById("btn");
    const resultField = document.getElementById("resultField");

    const activeTagSet = new Set();
    let lastText = "";

    function renderChips(){
      chipsWrap.innerHTML = "";
      for (const t of TAGS){
        const el = document.createElement("button");
        el.type = "button";
        el.className = "chip";
        el.textContent = t.label;
        el.setAttribute("aria-pressed", activeTagSet.has(t.id) ? "true" : "false");

        el.addEventListener("click", () => {
          if (activeTagSet.has(t.id)) activeTagSet.delete(t.id);
          else activeTagSet.add(t.id);

          el.setAttribute("aria-pressed", activeTagSet.has(t.id) ? "true" : "false");
        });

        chipsWrap.appendChild(el);
      }
    }

    function matchesFilters(idea){
      const tags = idea.tags || [];

      // 1) GATED теги: если идея про питомца/друзей/пару - показываем ТОЛЬКО если выбран соответствующий режим
      for (const gated of GATED_TAGS){
        if (tags.includes(gated) && !activeTagSet.has(gated)) return false;
      }

      // 2) Локации: если пользователь выбрал одну или несколько локаций, идея должна соответствовать
      // (Если локации не выбраны - локацию не требуем)
      const chosenLocations = [...activeTagSet].filter(t => LOCATION_TAGS.has(t));
      if (chosenLocations.length > 0){
        // идея подходит, если она содержит хотя бы одну выбранную локацию
        const ok = chosenLocations.some(loc => tags.includes(loc));
        if (!ok) return false;
      }

      // 3) Остальные выбранные теги (кроме локаций) - строгий AND
      for (const t of activeTagSet){
        if (LOCATION_TAGS.has(t)) continue; // локации уже проверили
        if (!tags.includes(t)) return false;
      }

      return true;
    }

    function pickIdea(){
      const pool = IDEAS.filter(matchesFilters);

      if (pool.length === 0){
        return "Нет идей под выбранные режимы. Попробуй снять один режим или выбрать другой.";
      }

      // избегаем повтора подряд
      let tries = 0;
      while (tries < 12){
        const item = pool[Math.floor(Math.random() * pool.length)];
        if (pool.length === 1 || item.text !== lastText){
          lastText = item.text;
          return item.text;
        }
        tries++;
      }
      const fallback = pool[Math.floor(Math.random() * pool.length)];
      lastText = fallback.text;
      return fallback.text;
    }

    function showIdea(){
      resultField.value = pickIdea();
    }

    renderChips();
    btn.addEventListener("click", showIdea);
  </script>
</body>
</html>
